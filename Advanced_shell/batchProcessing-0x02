#!/usr/bin/env bash

# List of Pokémon to retrieve
POKEMONS=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")

# Loop through each Pokémon in the list
for POKEMON in "${POKEMONS[@]}"; do
  # Convert the Pokémon name to lowercase to match API naming conventions
  LOWERCASE_NAME=$(echo "$POKEMON" | tr '[:upper:]' '[:lower:]')

  # API endpoint
  API_URL="https://pokeapi.co/api/v2/pokemon/${LOWERCASE_NAME}"

  OUTPUT_FILE="${LOWERCASE_NAME}.json"

  echo "Retrieving data for ${POKEMON}..."

  # Make the request using curl
  # -f: fail on HTTP errors
  # -sS: silent mode but still show errors
  # -o: output to the specified file
  if curl -f -sS "$API_URL" -o "$OUTPUT_FILE"; then
    echo "Data for ${POKEMON} saved to ${OUTPUT_FILE}"
  else
    echo "$(date): Failed to retrieve data for ${POKEMON}" >> errors.txt
    echo "Failed to retrieve data for ${POKEMON}, see errors.txt for details."
  fi

  # Delay to help avoid rate-limiting
  sleep 1
done
